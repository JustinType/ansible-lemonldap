- name: Set authentification mode to AD
  command: "/usr/share/lemonldap-ng/bin/lemonldap-ng-cli -yes 1 set authentication 'AD' | /usr/share/lemonldap-ng/bin/lemonldap-ng-cli -yes 1 set userDB 'AD' | /usr/share/lemonldap-ng/bin/lemonldap-ng-cli -yes 1 set passwordDB 'AD'"

- name: Set Ldap Server IP
  command: "/usr/share/lemonldap-ng/bin/lemonldap-ng-cli -yes 1 set ldapServer '{{ ldap_server_ip }}'"

- name: Set Ldap Server Port
  command : "/usr/share/lemonldap-ng/bin/lemonldap-ng-cli -yes 1 set ldapPort '{{ ldap_port }}'"

- name: Set Ldap Server Verification
  command: "/usr/share/lemonldap-ng/bin/lemonldap-ng-cli -yes 1 set ldapVerify '{{ ldap_verification }}'"

- name: Set Ldap Timeout
  command: "/usr/share/lemonldap-ng/bin/lemonldap-ng-cli -yes 1 set ldapTimeout '{{ ldap_timeout }}'"

- name: Set Ldap Base
  command: "/usr/share/lemonldap-ng/bin/lemonldap-ng-cli -yes 1 set ldapBase '{{ ldap_base }}'"

- name: Set Ldap Account
  command: "/usr/share/lemonldap-ng/bin/lemonldap-ng-cli -yes 1 set managerDn '{{ ldap_account }}'"

- name: Set Ldap Password
  command: "/usr/share/lemonldap-ng/bin/lemonldap-ng-cli -yes 1 set managerPassword '{{ ldap_password }}'"

- name: Set Custom Main Logo
  command: "cp skin_customization/{{ custom_main_logo }} /usr/share/lemonldap-ng/portal/htdocs/static/common/logos"
  command: "/usr/share/lemonldap-ng/bin/lemonldap-ng-cli -yes set portalMainLogo '{{ custom_main_logo }}'"
  when: custom_main_logo != 'default'

- name: Set Custom Favicon
  command: "cp skin_customization/{{ custom_favicon }} /usr/share/lemonldap-ng/portal/htdocs/static/common/logos"
  command: "/usr/share/lemonldap-ng/bin/lemonldap-ng-cli -yes set portalFavicon '{{ custom_favicon }}'"
  when: custom_favicon != 'default'

- name: Set Custom Background
  command: "cp skin_customization/{{ custom_background }} /usr/share/lemonldap-ng/portal/htdocs/static/common/backgrounds"
  command: "/usr/share/lemonldap-ng/bin/lemonldap-ng-cli -yes set portalSkinBackground '{{ custom_background }}'"
  when: custom_background != 'default'

- name: Restart Apache Service
  command: "systemctl restart apache2.service"